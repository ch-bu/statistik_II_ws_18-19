---
title: "Statistik II - Nachbereitungsaufgabe"
subtitle: "02 Wahrscheinlichkeitsverteilungen"
author: ""
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Fragen zur Wahrscheinlichkeitsverteilungen

## Frage 1

Bitte vervollständige folgenden Satz:

Eine Zufallsvariable ist eine *TODO*, die den Ergebnissen eines Zufallsexperiments (d.h. Elementarereignissen oder Ereignissen) reelle *TODO* zuordnet.


## Frage 2

Ordnen Sie folgende Definitionen den richtigen Begriffen zu:

* Unendlich viele Ausprägungen zwischen zwei Ausprägungen
* Keine weiteren Ausprägungen zwischen zwei benachbarten Ausprägungen

* Diskrete Zufallsvariable
* Stetige Zufallsvariable


## Frage 3

Bitte vervollständige folgenden Satz:

Bei Wahrscheinlichkeitsfunktionen von stetigen Zufallsvariablen ist auf der y-Achse nicht die *TODO* abgetragen, sondern die *TODO*

## Frage 4

Bitte vervollständige folgenden Satz:

In Tabellen mit z-Werten stehen in den einzelnen Zellen *TODO* die für das Auftreten der Werte von - unendlich bis zu dem jeweiligen *TODO* .


# R Anwendungsaufgaben

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
```

In dieser Anwendungsaufgabe üben wir die Arbeit mit Dataframes am Beispiel eines Filmdatensatzes. Zunächst müssen wir die Daten einlesen, mit Hilfe derer wir diese Frage beantworten. Nutzt hierfür die `read_csv` Funktion und vervollständigt folgenden Befehl:

`
movies <- NULL("movies.csv")
`

```{r}
# TODO: Hier den Dataframe crime einfügen
```

Als nächstes schauen wir uns die Variablennamen des Datensatzes an:

```{r}
colnames(movies)
```

Schaue dir die Variablen noch genauer mit der Funktion `glimpse` an:

```{r}
# TODO: Hier Glimpse eingeben
```

Die Variable `Runtime (Minutes)` ist etwas kompliziert geschrieben. Wir benennen daher die Variable um. Hierfür verwenden wir die [rename Funktion](https://dplyr.tidyverse.org/reference/select.html):

`
movies <- TODO %>%
  rename(TODO = `Runtime (Minutes)`)
`

```{r}
# TODO: Ändere den Namen der Variable Runtime (Minutes) zu minutes
```

Zunächst schauen wir uns die Variable mit Hilfe eines Histograms an. Vervollständige hierfür bitte folgende Befehle:

`
ggplot(NULL, aes(NULL)) +
  geom_histogram(fill = "blue", color = "black")
`

```{r}
# TODO: Hier Histogram eingeben
```

Wir können aus dem Histogram erkennen, dass die populären Filme durchschnittlich zwischen 90 und 130 Minuten dauern. Deskriptiv können wir den Mittelwert und die Standardverteilung dieser Verteilung bestimmen:

```{r}
# TODO: Bitte Mittelwert und Standardabweichungen der Variable ausgeben lassen
```

### Den Datensatz kennen lernen

Finde den längsten Film im Datensatz. Verwende hierfür die Funktion [arrange](https://dplyr.tidyverse.org/reference/arrange.html), head und den Pipe-Operator:

```{r}
# TODO: Längsten Film finden
```

Wie viele Filme haben mehr als 400 Millionen Dollar eingespielt? Verwende hierfür die [Filter Funktion](https://dplyr.tidyverse.org/reference/filter.html), den Pipe-Operator und die Funktion count:

`
movies %>%
  TODO: Filme filtern %>%
  count()
`

```{r}
# TODO: Filme filtern
```


Welcher Direktor hat die meisten Filme gemacht? Um diese Frage zu beantworten, können wir erneut die Count Funktion verwenden. Mit [arrange](https://dplyr.tidyverse.org/reference/arrange.html) können wir die Variablen absteigend ordnen. Vervollständige dazu folgenden Code:

`
movies %>%
  count(NULL) %>%
  arrange(NULL)
`

```{r}
# TODO: Häufigkeit der Filme pro Jahr ausgeben
```

## Freiwillige Zusatzsaufgabe: T-Verteilung

Die [T-Verteilung](https://de.wikipedia.org/wiki/Studentsche_t-Verteilung) ist der Standardnormalverteilung sehr ähnlich. In ihrer Form ist die Verteilung lediglich weniger hoch und breiter. Je größer eine Stichprobe ist, desto stärker ähnelt die T-Verteilung der Standardnormalverteilung. Die T-Verteilungen zählt zu den stetigen Verteilungen. 

### Simulation der T-Verteilung

Um zu verstehen, wie die T-Verteilung zu Stande kommt, schreiben wir eine Simulation. Als Population nehmen wir die 1000 Filme aus unserem Datensatz mit verschiedenen Ausprägungen der Variable `minuten`. Zunächst simulieren wir 4000 Experimente. Das Ereignis dieses Zufallsexperiments umfasst das Ziehen der Länge von 30 Filmen (Unser Ereignis). Wir ziehen also 4000 mal eine Stichprobe von 30 Filmen aus unserer Population. 

```{r}
set.seed(787)
samples <- c(1:4000) %>% map(~ sample_n(movies, 30) %>% 
                               {.$minutes})
```

Schaue dir die ersten Stichproben mit der `head`-Funktion an:

```{r}
# TODO: Mit head die ersten Stichproben der Variable samples ansehen
```


Für jedes dieser 4000 Stichproben berechnen wir den T-Wert, der mit folgender Formel berechnet wird. Durch den T-Wert können wir Werte standardisieren:

$$
t = \frac{\bar{x} - \mu}{\frac{s}{\sqrt{n}}}
$$

* $\mu$: Mittelwert der Population (hier Mittelwert der Länge der Filme)
* $\bar{x}$: Mittelwert des Samples
* $s$: Standardabweichung des Samples
* $t$: T-Wert

Berechnen wir nun den T-Wert für jedes dieser 4000 Samples:

```{r}
t_values <- samples %>% 
  map_dbl(~ (mean(.) - mean(movies$minutes)) / (sd(.) / sqrt(length(.))))
```

Diese T-Werte können wir uns auch als Histogram ausgeben lassen:

`
ggplot(NULL, aes(t_values)) +
  NULL(fill = "#f1a340", color = "black") +
  xlab("T-Werte") +
  ylab("Häufigkeit")
`

```{r}
# TODO: Erstelle ein Histogram der T-Werte 
```

Was wir nun sehen ist eine *Häufigkeitsverteilung* der T-Werte. Wir müssen diese Werte noch zu einer Dichtefunktion umwandeln und visualisieren, da die jede Wahrscheinlichkeitsverteilung stetiger Variablen eine [Dichtefunktion](https://de.wikipedia.org/wiki/Wahrscheinlichkeitsdichtefunktion) darstellt:

```{r}
ggplot(NULL, aes(t_values)) +
  geom_density(fill = "#f1a340", alpha = .5) +
  xlab("T-Werte") +
  ylab("Dichte")
```

Was du hier siehst ist die T-Verteilung. Damit wir uns aber sicher sind, dass diese Simulation tatsächlich einer T-Verteilung entspricht, können wir die T-Verteilung für Stichproben der Größe 30 (hier 30 Filme) darüber legen:

```{r}
ggplot(NULL, aes(t_values)) +
  geom_density(fill = "#f1a340", alpha = .5) +
  geom_area(stat = "function", fun = dt, 
            fill = "#998ec3", alpha = .5, 
            args = list(df = 29)) +
  xlab("T-Werte") +
  ylab("Dichte")
```

In der Tat entspricht unsere Verteilung der T-Verteilung. Warum ist unsere simulierte Verteilung ungleichmäßig? Weil jede Simulation durch statistisches Rauschen begleitet ist und nicht durch eine Formel berechnet wird. 

Die T-Verteilung ist also nichts anderes als die Verteilung von ganz vielen T-Werten, die wir aus einer Population ziehen. Aus dieser Häufigkeitsverteilung bilden wir eine Dichtefunktion, die wir später verwenden können, um Mittelwertsunterschiede zu bestimmen. Auf Grundlage der T-Verteilung werden wir später im Seminar bestimmen können, ob sich zwei Mittelwerte voneinander unterschieden. Beispielsweise können wir anhand dieser T-Verteilung bestimmen, ob ein Mittelwert einer Stichprobe im Vergleich zum Mittelwert der Population ungewöhnlich ist. Ein T-Wert von 2.4 zum Beispiel, der aus dem Mittelwert einer Stichprobe berechnet werden kann wäre ein solch ungewöhnlicher Wert, da die Fläche rechts diesen T-Werts sehr gering ist:

```{r}
ggplot(NULL, aes(t_values)) +
  geom_area(stat = "function", fun = dt, 
            fill = "#998ec3", alpha = .5, 
            args = list(df = 29)) +
  geom_vline(xintercept = 2.4) +
  xlab("T-Werte") +
  ylab("Dichte")
```

Die Fläche rechts von einem T-Wert von 2.4 ist in diesem Beispiel: `dt(2.4, 29)`. Einen solchen Wert zu erhalten, wenn man annimmt, dass die Stichprobe aus der Population ist sehr ungewöhnlich oder besser gesagt signifikant ;). 

Es gibt aber nicht nur eine T-Verteilung. Die Funktion umfasst eine Variable df (Freiheitsgrade), welche das Aussehen der Verteilung verändert:

```{r}
ggplot(NULL, aes(t_values)) +
  geom_area(stat = "function", fun = dt, 
            fill = "#998ec3", alpha = .5, 
            args = list(df = 29)) +
  geom_area(stat = "function", fun = dt, 
            fill = "#7fc97f", alpha = .5, 
            args = list(df = 5)) +
  xlab("T-Werte") +
  ylab("Dichte")
```

Hier siehst du zwei T-Verteilungen mit jeweils einem Freiheitsgrad von 29 und 5. Für jetzt genügt es zu wissen, dass es mehrere dieser T-Verteilungen gibt und dass mit steigendem Freiheitsgrad sich die T-Verteilung der Standardnormalverteilung annähert. 